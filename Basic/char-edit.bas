10 REM CHARACTER EDIT BY JUSTIN BALDOCK 2022
20 REM HTTPS://GITHUB.COM/JUSTINBALDOCK/X16-SPRITEEDIT
30 GOSUB 60000: REM SETUP VARIABLES
40 GOSUB 41000: REM DRAW UI
50 GOSUB 30000: REM DRAW CHAR-SET


100 REM MAIN LOOP
110 REM GET STATUS
120 REM GET CURSOR AND UPDATE
130 GOSUB 3000: REM PROCESS KEYBOARD 
140 GOTO 100
150 END

3000 REM FUNCTION GET KEYBOARD AND PROCESS
3010 GET KP$: REM KP$= KEY PRESS
3020 REM PROCESS CURSOR KEYS
3030 IF KP$=CHR$(157) THEN : REM LEFT
3040 IF KP$=CHR$(29) THEN : REM RIGHT
3050 IF KP$=CHR$(17) THEN : REM DOWN
3060 IF KP$=CHR$(145) THEN : REM UP
3070 REM PROCESS 123 KEYS
3080 IF KP$=CHR$(49) THEN UI=1: GOSUB 20000: REM 1 KEY
3090 IF KP$=CHR$(50) THEN UI=2: GOSUB 20000: REM 2 KEY
3100 IF KP$=CHR$(51) THEN UI=3: GOSUB 20000: REM 3 KEY
3110 REM CONTROL KEYS
3120 IF KP$=CHR$(81) THEN END: REM Q KEY TO QUIT
3130 IF KP$=CHR$(83) THEN : REM S KEY TO SAVE
3140 IF KP$=CHR$(76) THEN : REM L KEY TO LOAD
3150 RETURN

20000 REM MANAGE UI SELECTION
20010 IF UI=1 THEN 
20020 IF UI=2 THEN
20030 IF UI=3 THEN

21000 REM UI = 1 = CHAR

22000 REM UI = 2 = FONT-SET

23000 REM UI = 3 = SCRATCH-SPACE

30000 REM DRAW FONT-SET
30010 FOR Y = 0 TO 7
30020 FOR X = 0 TO 31
30030 VPOKE 0,$B02+(Y*$100)+(X*2),X+(31*Y)
30040 NEXT X
30050 NEXT Y
30100 RETURN

31000 REM DRAW UI CHAR CURSOR

31500 REM HIDE UI CHAR CURSOR

32000 REM DRAW UI FONT-SET CURSOR

32500 REM HIDE UI FONT-SET CURSOR

33000 REM DRAW UI SCRATCH-SPACE CURSOR

33500 REM DRAW UI SCRATCH-SPACE CURSOR

41000 REM DRAW MAIN SCREEN
41010 SCREEN($80): RECT 0,0,319,199,0
41020 OPEN 1,8,2,"CHAR-EDIT-IF,SEQ,R": REM INTERFACE FILE CREATED BY PETISDRAW
41030 GET#1,D$: IF ST=64 THEN RETURN
41040 GET#1,D$: REM FIRST 2 BYTES ARE NOT USEFUL
41050 FOR Y=0 TO 29
41060 FOR X=0 TO 79
41070 GET#1,D$
41080 VPOKE 0,0+((Y*256)+X),ASC(D$)
41090 NEXT X
41100 NEXT Y 
41110 CLOSE 1
41120 RETURN

60000 REM VARIABLES
60005 REM WHICH UI BOX ARE WE IN?
60006 0=NONE, 1=CHAR, 2=CHAR-SET, 3=SCRATCH, 4=PALETTE?
60010 LET UI = 0
60020 DIM CC(1):REM = CHAR BOX CURSOR X,Y, CC(0)=X CC(1)=Y
60030 DIM FC(1):REM = FONT BOX CURSOR X,Y FC(0)=X, FC(1)=Y
60040 DIM SC(1):REM = SCRATCH BOX CURSOR X,Y
60050 LET CD = $FC08: REM CD = CURSOR DATA
60060 GOSUB 61000: REM CREATE CURSOR SPRITE
60200 RETURN

61000 REM CURSOR SPRITE
61010 VPOKE 1,CD+0,%00000000: VPOKE 1,CD+1,%00000100: REM $8000
61020 VPOKE 1,CD+2,08: VPOKE 1,CD+3,00 :REM X
61030 VPOKE 1,CD+4,08: VPOKE 1,CD+5,00 :REM Y
61040 VPOKE 1,CD+6,%00001100: REM NO MASK, ON TOP ALL, NO FLIP
61050 VPOKE 1,CD+7,%00000000: REM 8X8 SPRITE WITH NO PAL OFFSET
61060 POKE $9F29,PEEK($9F29) OR %01000000: REM ENABLE SPRITES
61070 FOR I = 0 TO 31
61080 READ D
61090 VPOKE 0,$8000+I,D
61100 NEXT I
61200 RETURN

62000 REM CURSOR SPRITE DATA 8 BPP
62010 REM DATA 00,07,07,07,07,07,07,00
62020 REM DATA 07,00,00,00,00,00,00,07
62030 REM DATA 07,00,00,00,00,00,00,07
62040 REM DATA 07,00,00,00,00,00,00,07
62050 REM DATA 07,00,00,00,00,00,00,07
62060 REM DATA 07,00,00,00,00,00,00,07
62070 REM DATA 07,00,00,00,00,00,00,07 
62080 REM DATA 00,07,07,07,07,07,07,00

62100 REM CUSROR SPRITE DATA 4 BPP
62110 DATA $07,$77,$77,$70
62120 DATA $70,$00,$00,$07
62130 DATA $70,$00,$00,$07
62140 DATA $70,$00,$00,$07
62150 DATA $70,$00,$00,$07
62160 DATA $70,$00,$00,$07
62170 DATA $70,$00,$00,$07
62180 DATA $07,$77,$77,$70
